#pragma once 
inline const char* index_html = R"multiline( 
<!doctype html><html lang=en><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Solar Tracker</title><style>body{padding:0;margin:0}body *{box-sizing:border-box}#wsstate{height:2px;width:100%;background-color:red}#wsstate.on{background-color:green}</style><main><div id=wsstate></div><section id=advanced><h3>Preferances</h3><table id=prefs></table><button onclick=prefs_download()>Download</button> <button onclick=prefs_upload()>Upload</button> <button onclick=prefs_load()>Load</button> <button onclick=prefs_save()>Save</button><h3>Commands</h3><input id=cmd> <button onclick='cmd_execute(E("cmd").value)'>Execute</button></section><section><h2>Witaj w Solar Trackerze!</h2><p>Czas: <span id=s_time>?</span><fieldset><legend>Sterowanie Automatyczne</legend><p>Tryb Sterowania: <span id=s_cmode>?</span><p><button onclick='cmd_execute("ctrlsun")'>Włącz Tryb Automatyczny (pozycja słońca)</button></fieldset><fieldset><legend>Pozycja Słońca</legend><p>Azymut: <span id=s_azim>?</span><p>Wysokość: <span id=s_alti>?</span><p>Docelowa Pozycja Osi Poziomej: <span id=s_shtpos>?</span>%</fieldset><fieldset><legend>Oś Pozioma</legend><p>Wymuś Stan:</p><button onclick='cmd_execute("hmotor 0")'>Swobodny</button> <button onclick='cmd_execute("hmotor 1")'>Hamowanie Szybkie</button> <button onclick='cmd_execute("hmotor 2")'>Hamowanie</button><br><button onclick='cmd_execute("hmotor 3")'>Ruch &lt;--</button> <button onclick='cmd_execute("hmotor 4")'>Ruch --&gt;</button><br><button onclick='cmd_execute("hmotor 5")'>Kalibracja</button><p><input id=in_hpos> <button onclick='cmd_execute("gotoposp "+E("in_hpos").value)'>Wymuś Pozycję</button><p><input id=in_hazim> <button onclick='cmd_execute("gotoazim "+E("in_hazim").value)'>Wymuś Azymut</button></p><br><p>Stan: <span id=s_hstate>?</span><p>Zkalibrowana: <span id=s_hcal>Nie</span><p>Pozycja: <span id=s_hpos>?</span>%<p>Azymut: <span id=s_hazim>?</span></fieldset><br><button onclick=toggle_advanced()>Opcje Zaawansowane</button></section></main><script>function decode_prefs(e){return e.split(",").map((e=>e.split("|")))}function encode_prefs(e){return e.map((e=>e.join("|"))).join(",")}function populate_prefs(e){prefs_elem.innerHTML=e.map((e=>"<tr>"+e.map((e=>'<td><input value="'+e+'"/></td>')).join("")+"</tr>")).join("")}function extract_prefs(){return Array.from(prefs_elem.rows).map((e=>Array.from(e.children).map((e=>e.firstChild.value)).join("|"))).join(",")}function decode_state(e){let a={},t=e.split("|");return a.cmode=+t[1],a.hstate=+t[2],a.hcal="1"==t[3],a.hmax=+t[4],a.hpos=+t[5],a.htpos=+t[6],a.htposd=+t[7],a.hsens1=+t[8],a.hsens2=+t[9],a.alti=+t[10],a.azim=+t[11],a.shtpos=+t[12],a.time=+t[13],a}function populate_state(e){let a=(e,a)=>E("s_"+e).innerHTML=a;a("time",new Date(1e3*e.time)),a("cmode",cmode_names[e.cmode]),a("azim",e.azim.toFixed(3)),a("alti",e.alti.toFixed(3)),a("shtpos",(e.shtpos/e.hmax*100).toFixed(3)),a("hstate",state_names[e.hstate]),a("hcal",e.hcal?"Tak":"Nie"),a("hpos",(e.hpos/e.hmax*100).toFixed(3))}function prefs_download(){ws.send("d")}function prefs_upload(){ws.send("u"+extract_prefs())}function cmd_execute(e){ws.send("c"+e)}function prefs_load(){cmd_execute("cfgload")}function prefs_save(){cmd_execute("cfgsave")}function request_state(){ws.send("r")}function toggle_advanced(){adv=1-adv,params.set("adv",adv),location.search=params}adv=1,params=new URLSearchParams(location.search),"1"!=params.get("adv")&&(document.getElementById("advanced").style.display="none",adv=0),prefs_elem=document.getElementById("prefs"),wsstate_elem=document.getElementById("wsstate"),wsurl=params.get("wsurl")||"ws://"+location.hostname+":81",ws=new WebSocket(wsurl),wsinterval_val=params.get("wsinterval")||200,wsinterval=null,ws.onopen=e=>{console.log("WS opened"),wsstate_elem.className="on",wsinterval=setInterval(request_state,wsinterval_val)},ws.onerror=e=>{console.log("WS error",e),wsstate_elem.className="",clearInterval(wsinterval)},ws.onclose="close",ws.onmessage=e=>{console.log("WS message",e.data),"d"==e.data[0]?populate_prefs(decode_prefs(e.data.slice(1))):"r"==e.data[0]&&(state=decode_state(e.data.slice(1)),populate_state(state))},E=e=>document.getElementById(e),cmode_names=["Manualny","Pozycjonowanie","Automatycznye (czujniki)","Automatyczny (pozycja słońca)"],state_names=["Swobodny","Hamowanie Szybkie","Hamowanie","Ruch w lewo","Ruch w prawo","Kalibracja"]</script>
)multiline"; 
